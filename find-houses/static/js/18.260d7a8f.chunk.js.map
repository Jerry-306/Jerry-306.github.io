{"version":3,"sources":["components/MyNavBar/index.jsx","components/MyNavBar/index.module.css","../node_modules/antd-mobile/lib/nav-bar/style/css.js","../node_modules/antd-mobile/lib/nav-bar/index.js","utils/city.js","pages/CityList/index.jsx"],"names":["withRouter","children","className","history","rightContent","onLeftClick","styles","navbar","join","mode","icon","goBack","module","exports","require","Object","defineProperty","value","_extends3","_interopRequireDefault","_classCallCheck3","_createClass3","_possibleConstructorReturn3","_inherits3","_classnames2","React","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","_interopRequireWildcard","__rest","s","e","t","p","indexOf","getOwnPropertySymbols","i","length","NavBar","_React$Component","this","__proto__","getPrototypeOf","apply","arguments","_a","props","prefixCls","leftContent","restProps","createElement","role","onClick","Component","defaultProps","getCity","JSON","parse","localStorage","getItem","CityList","useState","cityList","setcityList","cityIndex","setcityIndex","activeIndex","setactiveIndex","cityListComponent","useRef","formatCityIndex","letter","toUpperCase","useEffect","formatCityData","list","forEach","item","firstStr","short","substr","push","keys","sort","getCityList","a","loading","API","get","res","hide","data","body","hotCities","unshift","currentCity","current","measureAllRows","rowRenderer","index","style","map","changeCity","label","rowsRendered","startIndex","getRowHeight","city","setItem","stringify","width","height","ref","rowCount","rowHeight","onRowsRendered","scrollToAlignment","scrollToRow"],"mappings":"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","file":"static/js/18.260d7a8f.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { NavBar } from \"antd-mobile\";\r\nimport styles from \"./index.module.css\";\r\n\r\nfunction MyNavBar({ \r\n  children,\r\n  className,\r\n  history,\r\n  rightContent,\r\n  onLeftClick \r\n}) {\r\n  // 默认点击返回按钮事件\r\n  const defaultClick = () => history.goBack();\r\n  return (\r\n    <div>\r\n      <NavBar\r\n        className={[styles.navbar, className || \"\"].join(\" \")}\r\n        mode=\"light\"\r\n        icon={<i className=\"iconfont icon-back\" />}\r\n        onLeftClick={onLeftClick || defaultClick}\r\n        rightContent={rightContent}\r\n      >\r\n        {children}\r\n      </NavBar>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(MyNavBar);\r\n/* \r\n此组件用于封装顶部导航栏\r\n只有路由组件才有history 等API\r\n于是， 利用 withRouter（）函数 包裹一般组件，就可以把一般组件变成路由组件 \r\n*/","// extracted by mini-css-extract-plugin\nmodule.exports = {\"navbar\":\"MyNavBar_navbar__2081X\"};","'use strict';\n\nrequire('../../style/css');\n\nrequire('./index.css');","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _react = require('react');\n\nvar React = _interopRequireWildcard(_react);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar __rest = undefined && undefined.__rest || function (s, e) {\n    var t = {};\n    for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n    }if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n        if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n    }return t;\n};\n\nvar NavBar = function (_React$Component) {\n    (0, _inherits3['default'])(NavBar, _React$Component);\n\n    function NavBar() {\n        (0, _classCallCheck3['default'])(this, NavBar);\n        return (0, _possibleConstructorReturn3['default'])(this, (NavBar.__proto__ || Object.getPrototypeOf(NavBar)).apply(this, arguments));\n    }\n\n    (0, _createClass3['default'])(NavBar, [{\n        key: 'render',\n        value: function render() {\n            var _a = this.props,\n                prefixCls = _a.prefixCls,\n                className = _a.className,\n                children = _a.children,\n                mode = _a.mode,\n                icon = _a.icon,\n                onLeftClick = _a.onLeftClick,\n                leftContent = _a.leftContent,\n                rightContent = _a.rightContent,\n                restProps = __rest(_a, [\"prefixCls\", \"className\", \"children\", \"mode\", \"icon\", \"onLeftClick\", \"leftContent\", \"rightContent\"]);\n            return React.createElement(\n                'div',\n                (0, _extends3['default'])({}, restProps, { className: (0, _classnames2['default'])(className, prefixCls, prefixCls + '-' + mode) }),\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-left', role: 'button', onClick: onLeftClick },\n                    icon ?\n                    // tslint:disable-next-line:jsx-no-multiline-js\n                    React.createElement(\n                        'span',\n                        { className: prefixCls + '-left-icon', 'aria-hidden': 'true' },\n                        icon\n                    ) : null,\n                    leftContent\n                ),\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-title' },\n                    children\n                ),\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-right' },\n                    rightContent\n                )\n            );\n        }\n    }]);\n    return NavBar;\n}(React.Component);\n\nexports['default'] = NavBar;\n\nNavBar.defaultProps = {\n    prefixCls: 'am-navbar',\n    mode: 'dark',\n    onLeftClick: function onLeftClick() {}\n};\nmodule.exports = exports['default'];","const CITY = 'zfy_city';\r\n\r\nconst getCity = () => JSON.parse(localStorage.getItem(CITY)) \r\n\r\nexport { getCity }","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { AutoSizer, List } from \"react-virtualized\";\r\nimport MyNavBar from \"../../components/MyNavBar\";\r\nimport { Toast } from \"antd-mobile\";\r\nimport { getCity } from \"../../utils/city\";\r\nimport API from \"../../utils/api\";\r\nimport \"./index.css\";\r\n\r\n// 索引（A、B等）的高度\r\nconst TITLE_HEIGHT = 36;\r\n// 每个城市名称的高度\r\nconst NAME_HEIGHT = 50;\r\n// 目前有房源的城市\r\n// const HOUSE_CITIES = ['北京', '南京', '上海', '广州', '深圳'];\r\n\r\nexport default function CityList(props) {\r\n  const [cityList, setcityList] = useState({});\r\n  const [cityIndex, setcityIndex] = useState([]);\r\n  const [activeIndex, setactiveIndex] = useState(0);\r\n  const cityListComponent = useRef(null);\r\n  // 获取城市列表数据\r\n  useEffect(() => {\r\n    // 城市数据格式化\r\n    function formatCityData(list) {\r\n      let cityList = {};\r\n      let cityIndex = [];\r\n      // 将城市列表list按照首字母进行分类\r\n      list.forEach((item) => {\r\n        let firstStr = item.short.substr(0, 1);\r\n        if (cityList[firstStr]) {\r\n          cityList[firstStr].push(item);\r\n        } else {\r\n          cityList[firstStr] = [item];\r\n        }\r\n      });\r\n      // 获取城市列表首字母数组\r\n      cityIndex = Object.keys(cityList).sort();\r\n      return {\r\n        cityList,\r\n        cityIndex,\r\n      };\r\n    }\r\n    const getCityList = async () => {\r\n      Toast.loading(\"Loading...\", 0, null, false);\r\n      const res = await API.get(\"/area/city?level=1\");\r\n      Toast.hide();\r\n      const { cityList, cityIndex } = formatCityData(res.data.body);\r\n\r\n      // 获取热门城市,并添加至数据中\r\n      const hotCities = await API.get(\"/area/hot\");\r\n      cityList[\"hot\"] = hotCities.data.body;\r\n      cityIndex.unshift(\"hot\");\r\n\r\n      // 获取当前定位城市\r\n      const currentCity = getCity();\r\n      cityList[\"#\"] = [currentCity];\r\n      cityIndex.unshift(\"#\");\r\n      setcityList(cityList);\r\n      setcityIndex(cityIndex);\r\n      cityListComponent.current.measureAllRows();\r\n    };\r\n    getCityList();\r\n  }, []);\r\n\r\n  // 封装处理字母索引的方法\r\n  function formatCityIndex(letter) {\r\n    switch (letter) {\r\n      case \"#\":\r\n        return \"当前定位\";\r\n      case \"hot\":\r\n        return \"热门城市\";\r\n      default:\r\n        return letter.toUpperCase();\r\n    }\r\n  }\r\n\r\n  // List组件渲染每一行的方法：\r\n  const rowRenderer = ({ key, index, style }) => {\r\n    // 字母索引\r\n    const letter = cityIndex[index];\r\n\r\n    return (\r\n      <div key={key} style={style} className=\"city\">\r\n        <div className=\"title\">{formatCityIndex(letter)}</div>\r\n        {\r\n          // 渲染指定字母索引下的城市列表数据\r\n          cityList[letter].map((item) => (\r\n            <div\r\n              className=\"name\"\r\n              key={item.value}\r\n              onClick={() => changeCity(item)}\r\n            >\r\n              {item.label}\r\n            </div>\r\n          ))\r\n        }\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // 用于获取List 组件中渲染行的信息\r\n  const rowsRendered = ({ startIndex }) => {\r\n    // startIndex 当前城市列表顶部的索引号\r\n    if (startIndex !== activeIndex) {\r\n      setactiveIndex(startIndex);\r\n    }\r\n  };\r\n\r\n  // 创建动态计算每一行高度的方法\r\n  const getRowHeight = ({ index }) => {\r\n    return TITLE_HEIGHT + cityList[cityIndex[index]].length * NAME_HEIGHT;\r\n  };\r\n\r\n  // 封装渲染右侧索引列表的方法\r\n  const renderCityIndex = () => {\r\n    // 获取到 cityIndex，并遍历其，实现渲染\r\n    return cityIndex.map((item, index) => (\r\n      <li\r\n        className=\"city-index-item\"\r\n        key={item}\r\n        onClick={() => {\r\n          cityListComponent.current.scrollToRow(index);\r\n        }}\r\n      >\r\n        <span className={activeIndex === index ? \"index-active\" : \"\"}>\r\n          {item === \"hot\" ? \"热\" : item.toUpperCase()}\r\n        </span>\r\n      </li>\r\n    ));\r\n  };\r\n\r\n  // 点击切换城市\r\n  const changeCity = (city) => {\r\n    const { label, value } = city;\r\n    localStorage.setItem(\"zfy_city\", JSON.stringify({ label, value }));\r\n    props.history.goBack();\r\n  };\r\n  return (\r\n    <div className=\"citylist\">\r\n      <MyNavBar>城市选择</MyNavBar>\r\n      {/* 城市列表 */}\r\n      <AutoSizer>\r\n        {({ width, height }) => (\r\n          <List\r\n            ref={cityListComponent}\r\n            width={width}\r\n            height={height}\r\n            rowCount={cityIndex.length}\r\n            rowHeight={getRowHeight}\r\n            rowRenderer={rowRenderer}\r\n            onRowsRendered={rowsRendered}\r\n            scrollToAlignment=\"start\"\r\n          />\r\n        )}\r\n      </AutoSizer>\r\n      {/* 右侧索引列表 */}\r\n      <ul className=\"city-index\">{renderCityIndex()}</ul>\r\n    </div>\r\n  );\r\n}\r\n"],"sourceRoot":""}